<div #spreadWrapper
     class="wrapper"
     [formGroup]="form">
  <table class="spread-table"
         id="spreadTableHeader"
         style="height: auto;">
    <tbody class="spread-thead">
      <tr>
        <td style="width: 30px;">
          <div [style.width]="indexWidth+'px'">Index
          </div>
        </td>
        <td *ngFor="let column of columns">
          <div [style.width]="column.width || '100px'">{{column.displayName}}</div>
        </td>
        <td style="width: 10px;padding:0;border:0">
        </td>
      </tr>
    </tbody>
  </table>

  <cdk-virtual-scroll-viewport [itemSize]="itemSize">

    <table #spreadTable
           tabindex="-1"
           class="spread-table"
           contenteditable="true"
           id="spreadTable">
      <tbody contenteditable="false"
             class="spread-tbody">
        <tr class="spread-row"
            *cdkVirtualFor="let row of data;let i = index">
          <td>
            <div [style.width]="indexWidth+'px'">{{row.rowIndex}}</div>
          </td>
          <td #spreadCell
              class="spread-cell"
              [style.height]="itemSize+'px'"
              (contextmenu)="openContextMenu($event,row.cells[j]);"
              (dblclick)="column.editable ? doubleClick(row.cells[j]) : ''"
              (mousedown)="cellClick($event,row.cells[j])"
              (mouseover)="mouseOverCall(row.cells[j])"
              [ngClass]="[isInEditMode(row.cells[j]) ? 'no-padding':'',
            row.cells[j]?.selected  ? 'selected' : '',
            row.cells[j]?.errors  ? 'has-errors' : '',
            column.editable ? '' : 'not-editable']"
              *ngFor="let column of columns;let j = index">
            <div style="height: 100%;"
                 class="error tooltip w-100">
              <div class="spread-cell-value hideextra"
                   [style.width]="column.width || '100px'"
                   *ngIf="!isInEditMode(row.cells[j])">{{getCellValue(row,column.name)}}</div>
              <input *ngIf="isInEditMode(row.cells[j])"
                     type="text"
                     class="cell-in-edit w-100"
                     (blur)="setCellValue(columns[j],row.cells[j])"
                     [formControlName]="columns[j].name" />
              <span *ngIf="row.cells[j].errors"
                    class="tooltiptext tooltip-bottom"
                    [innerHtml]="row.cells[j].errors"></span>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </cdk-virtual-scroll-viewport>
</div>
<app-context-menu #contextMenu
                  *ngIf="contextMenuItems().length > 0 && isDisplayContextMenu"
                  [contextMenuItems]="contextMenuItems()"
                  (onContextMenuItemClick)="handleMenuItemClick($event)"></app-context-menu>
